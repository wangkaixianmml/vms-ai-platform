"""
提示词模板文件，用于AI相关功能
"""

# 漏洞自动补全提示词
VULNERABILITY_AUTOCOMPLETE_PROMPT = """
你是一个专业的网络安全专家，现在需要你分析一个漏洞并提供详细信息。
根据提供的漏洞名称和CVE编号（如果有），补充以下信息：

1. 漏洞类型：确定这是什么类型的漏洞（如SQL注入、XSS、远程代码执行等）
2. 风险等级：根据漏洞的严重程度，评估风险等级（高、中、低）
3. CVSS评分：根据漏洞的严重程度，评估CVSS评分（0-10）
4. 漏洞描述：简明扼要地描述漏洞的本质和可能的攻击途径
5. 修复步骤：提供具体可行的修复或缓解措施
6. 漏洞危害：详细说明漏洞可能导致的安全影响和潜在后果
7. 影响组件：指出受影响的软件组件、版本或系统

请注意：
- 如果某项信息无法确定，请标记为"无法确定"
- 基于已知信息提供尽可能准确的评估，不要臆测
- 所有回答必须采用JSON格式，确保可以直接解析使用

输入信息：
漏洞名称：{vulnerability_name}
CVE编号：{cve_id}

请以以下JSON格式回答：
```json
{{
  "vulnerability_type": "漏洞类型",
  "risk_level": "风险等级",
  "cvss_score": 评分数值,
  "description": "漏洞详细描述",
  "remediation_steps": "修复步骤",
  "impact_details": "漏洞危害",
  "affected_components": "影响组件"
}}
```
"""

# 漏洞风险评估提示词
VULNERABILITY_RISK_ASSESSMENT_PROMPT = """
你是一名高级漏洞风险评估专家，需要对以下漏洞进行全面的风险评估。请根据提供的信息，分析漏洞的风险程度并给出客观的VPR评分和优先级。

分析依据的信息如下：
- 漏洞名称：{name}
- CVE编号：{cve_id}
- 漏洞类型：{vulnerability_type}
- 当前风险等级：{risk_level}
- 漏洞描述：{description}
- 漏洞危害：{impact_details}
- 漏洞影响范围：{impact_scope}
- 影响组件：{affected_components}
- 关联资产信息：{asset_info}

重要说明：
1. 必须使用提供的关联资产信息进行评估，即使某些字段显示为"未知"
2. 如果资产信息显示为"未知"，请基于漏洞类型和影响范围进行合理推断
3. 不得忽略或跳过任何资产属性的评估
4. VPR评分和优先级必须严格遵循以下映射关系：
   - VPR评分在8.5-10.0之间应对应优先级"紧急"
   - VPR评分在6.5-8.4之间应对应优先级"高"
   - VPR评分在4.0-6.4之间应对应优先级"中"
   - VPR评分在0.0-3.9之间应对应优先级"低"

对关联资产的评估必须严格按照以下属性进行：
1. 资产等级（高/中/低）- 资产的重要程度
2. 资产网络属性（内网/外网/DMZ）- 资产所在网络位置
3. 资产暴露面 - 资产对外暴露的范围和程度
4. 业务系统 - 资产所属的业务系统
5. 业务影响 - 资产对业务的影响程度

请按照以下步骤进行评估：
1. 分析漏洞的技术风险（基于漏洞类型、CVE信息、漏洞描述等）
2. 分析资产和业务风险（基于上述5个资产属性）
3. 综合评估并计算VPR评分(0-10)
4. 根据VPR评分确定优先级（紧急、高、中、低）

请以以下JSON格式返回评估结果：
```json
{{
  "vpr_score": 评分数值(0-10),
  "priority": "紧急/高/中/低",
  "assessment_reasoning": "详细评估理由，解释VPR评分和优先级的计算依据",
  "technical_risk_factors": ["列出影响技术风险评分的关键因素"],
  "business_risk_factors": ["列出影响业务风险评分的关键因素"],
  "remediation_priority": "修复建议和优先级说明",
  "asset_assessment": {{
    "asset_level": "资产等级评估结果",
    "network_property": "网络属性评估结果",
    "exposure": "暴露面评估结果",
    "business_system": "业务系统评估结果",
    "business_impact": "业务影响评估结果"
  }}
}}
```

优先级说明：
- 紧急：需要立即修复的高危漏洞，对业务有严重影响
- 高：重要系统的高风险漏洞，应优先安排修复
- 中：有一定风险但影响有限的漏洞
- 低：风险较小，可以在常规维护中修复的漏洞

注意：
- 确保你的分析全面、客观，且基于所提供的信息
- 如果关键信息缺失，请在分析中指出，并基于可用信息做出最佳评估
- 评分应符合业界标准，并保持一致性
- 提供详细的评估理由，确保评估结果具有说服力
- 必须对每个资产属性进行评估，即使原始信息显示为"未知"
- VPR评分和优先级必须一致，严格遵守上述映射关系
"""

# 漏洞分析提示词
VULNERABILITY_ANALYSIS_PROMPT = """
你是一名经验丰富的安全分析师，请对以下漏洞进行深入分析，提供专业的评估和见解。

漏洞信息：
- 漏洞名称：{name}
- CVE编号：{cve_id}
- 漏洞类型：{vulnerability_type}
- 当前风险等级：{risk_level}
- 漏洞描述：{description}
- 漏洞危害：{impact_details}
- 影响组件：{affected_components}
- 发现时间：{discovery_date}
- 状态：{status}

请从以下几个方面进行分析：
1. 漏洞成因和技术原理
2. 潜在的攻击场景和利用方式
3. 安全影响的实际严重程度评估
4. 漏洞在当前环境中的扩散风险
5. 相似漏洞的历史案例和教训

请提供一份结构化、详细、专业的分析报告，语言应当简洁明了，内容要有实质性的技术深度。避免泛泛而谈，要紧扣具体漏洞的特点进行分析。报告中应当包括你基于专业知识对该漏洞的独到见解，以及可能被忽视的风险点。

回应格式要求：
- 使用markdown格式组织内容
- 使用标题和小标题清晰分隔不同部分
- 关键技术术语或重要概念可以适当加粗标记
- 如有必要，可以使用列表形式呈现要点
- 避免过长的段落，保持良好的可读性
"""

# 漏洞修复建议提示词
VULNERABILITY_REMEDIATION_PROMPT = """
你是一名资深的网络安全修复专家，请针对以下漏洞提供专业、详细且可操作的修复建议。

漏洞信息：
- 漏洞名称：{name}
- CVE编号：{cve_id}
- 漏洞类型：{vulnerability_type}
- 当前风险等级：{risk_level}
- 漏洞描述：{description}
- 影响组件：{affected_components}
- 当前修复状态：{status}

请提供以下内容：
1. 立即修复措施 - 详细的步骤，包括必要的代码示例、配置更改或系统更新指南
2. 验证步骤 - 如何确认修复已成功完成
3. 长期解决方案 - 防止类似问题再次发生的策略
4. 相关参考资料 - 官方文档、CVE详情或相关安全公告的链接

请确保你的建议：
- 具体且可操作 - 避免泛泛而谈
- 分步骤列出 - 使用编号或清晰的分隔符
- 考虑潜在的副作用和风险 - 说明可能的服务中断或需要的额外步骤
- 针对不同环境提供替代方案 - 考虑生产和开发环境的不同需求

最后，请提供一个优先级建议（紧急/高/中/低）并说明理由。

回应格式要求：
- 使用markdown格式组织内容
- 使用标题和小标题清晰分隔不同部分
- 代码块和命令使用适当的格式标记
- 关键步骤和警告信息可以适当加粗标记
""" 

# 数据分析图表生成提示词
DATA_CHART_GENERATION_PROMPT = """
你是一名专业的安全数据分析师和可视化专家，请根据用户的自然语言描述，生成符合要求的数据图表。

分析范围内的数据：
- 漏洞数据: {vulnerability_data}
- 资产数据: {asset_data}
- 分析时间范围: {time_range}
- 特定查询条件: {filter_conditions}
- 是否使用高级分析: {use_advanced_analysis}

用户的要求描述：
{user_description}

请分析用户的需求，并生成一个包含以下内容的JSON响应：

1. 推荐的图表类型
2. 适合展示的数据字段和指标
3. 生成图表所需的数据结构
4. 图表配置选项（包括标题、颜色、图例等）

{advanced_analysis_instructions}

请基于提供的数据执行以下步骤：
1. 理解用户需求，确定最佳图表类型
2. 从提供的数据中筛选和聚合相关数据点
3. 构建符合ECharts或Ant Design Charts要求的图表配置
4. 提供简洁的图表分析结论和解读

响应格式要求：
```json
{{
  "chart_type": "图表类型（pie/bar/line/radar等）",
  "title": "图表标题",
  "description": "对图表的简要描述和分析结论",
  "data": [
    // 图表数据，格式根据图表类型而定
  ],
  "config": {{
    // ECharts或Ant Design Charts的配置选项
  }},
  "category": "图表分类（如'漏洞分布'、'风险趋势'等）",
  "applied_filters": "应用的筛选条件描述"
}}
```

请注意：
- 选择最能直观呈现数据特点的图表类型
- 确保图表配置符合ECharts或Ant Design Charts的规范
- 图表标题和轴标签应当简洁明了
- 配色应当符合数据可视化最佳实践
- 如果用户描述不够具体，应基于专业知识选择最有价值的数据维度进行展示
""" 